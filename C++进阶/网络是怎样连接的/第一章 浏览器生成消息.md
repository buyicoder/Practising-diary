# 第一章 浏览器生成消息

## 生成HTTP请求消息

### 探索之旅从输入网址开始

网址，准确来说叫URL

#### 浏览器的功能：

- 访问Web服务器
- 访问FTP服务器
- 电子邮件客户端

#### 常见URL格式

![image-20250801193523566](C:\Users\86135\AppData\Roaming\Typora\typora-user-images\image-20250801193523566.png)

### 浏览器先要解析URL

http: 

//

Web服务器名

文件路径名

### 省略文件名的情况

省略文件名会访问默认的文件名

省略整个路径会访问跟木下设置的默认文件

### HTTP的基本思路

HTTP协议定义了客户端和服务器之间交互的消息内容和步骤

- 客户端向服务器发送请求消息
  - 操作对象，URI
  - 操作，方法
    - GET，获取网页数据
    - POST，在表单中填写数据并将其发送给Web服务器，指向Web服务器中运行的一个应用程序的文件名，Web服务器从应用程序接收输出的结果，将它存放到响应消息中并返回给客户端
    - HEAD
    - OPTIONS
    - PUT
    - DELETE
    - TRACE
    - CONNECT
- Web服务器对消息进行解析，完成操作，将结果存放在响应消息中
  - 状态码

### 生成HTTP请求消息

- 第一行，请求行：
  - 方法，方法的选择取决于浏览器的状态
  - URI：文件路径名
  - HTTP版本号

- 第二行开始，消息头：
  - 日期
  - 客户端支持的数据类型
  - 语言
  - 压缩格式
  - 客户端和服务器的软件名称和版本
  - 数据有效期和最后更新时间
- 空行
- 消息体：

### 发送请求后会收到响应

- 状态码，用来给程序看的
  - 1xx，告知请求的处理进度和情况
  - 2xx，成功
  - 3xx，表示需要进一步操作
  - 4xx，客户端错误
  - 5xx，服务器错误
- 响应短语，用来给人看的

## 向DNS服务器查询Web服务器的IP地址

### IP地址的基本知识

几台计算机通过集线器连接起来形成子网

子网通过路由器连接起来形成网络

子网于整个网络对应网络号

计算机于子网对应主机号

网络号+主机号称为IP地址

### 域名和IP并用的理由

域名适合人用，IP适合机器用

### Socket库提供查询IP地址的功能

DNS解析器，简称解析器

### 通过解析器向DNS服务器发出查询

向DNS服务器发送查询消息，然后DNS服务器会返回响应消息

### 解析器的内部原理

- 根据DNS规格，生成一条”请告诉我www.lab.glasscom.com的IP地址“的数据，发送给DNS服务器
- 委托给协议栈来执行
- 协议栈通过网卡发送给DNS
- DNS服务器IP地址提前知道

## 全世界DNS服务器大接力

### DNS服务器的基本工作

查询消息的组成：

- 域名
- Class
- 记录类型

查询IP地址的记录类型为A，查询邮件服务器的记录类型为MX，根据IP地址查询域名为PTR

### 域名的层次结构

根域的DNS服务器信息保存在互联网中所有的DNS服务器中。任何DNS服务器都可以找到并访问根域DNS服务器。

如果缓存中没有，则从根域开始一层层往下寻找

DNS不负责转发，只负责响应将下一个要询问的DNS的IP地址

## 委托协议栈发送消息

### 数据收发操作概览

创建套接字

建立连接

收发数据

断开连接

所有操作由协议栈执行

#### 