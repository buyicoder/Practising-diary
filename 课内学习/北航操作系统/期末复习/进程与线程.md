## 程序顺序执行的特征

- 顺序性
- 封闭性
- 可再现性

## 程序并发执行的特征

- 间断性
- 非封闭性
- 不可再现性

## 数据竞争

多个进程在没有同步保护的情况下访问同一个共享变量，至少有一个是写

==数据竞争，原子性违反，死锁是三类典型的并发错误==

## Bernstein条件

判断程序并发执行结果是否可再现的充分条件

## 进程的定义和特征

进程是程序在一个数据集合上运行的过程，是系统进行资源分配和调度的一个独立单位

- 动态性
- 并发性
- 独立性
- 异步性
- 结构特征：程序段，数据段，进程控制块

## 中断处理触发的进程切换流程

- 硬件压入堆栈程序计数器等
- 硬件从中断向量装入新的程序计数器
- 汇编语言过程保存寄存器的值
- 汇编语言过程设置新的堆栈
- C中断服务例程运行
- 调度程序决定下一个将运行的进程
- C过程返回至汇编代码
- 汇编语言过程开始运行新的当前过程

首先是硬件，然后是汇编语言过程，然后是中断服务例程，然后是调度程序，然后返回，最后运行新进程

## 进程与线程

- 操作系统将次元拥有者称为进程
- 将可执行单元称为线程

引入线程的目的：

- 减小进程切换开销
- 提高进程内并发程度
- 共享资源

==每个线程有自己的堆栈==

## 线程的实现方式

### 用户级线程

#### 优点

- 线程切换与内核无关
- 线程的调度由应用决定，容易进行优化
- 可运行在任何操作系统上

#### 缺点

- 很多系统调用会引起阻塞，一但阻塞了所有的线程都无法运行
- 内核只能将处理器分配给进程，即使由多个处理器，也无法实现一个进程中的多个线程的并行执行

### 内核级别线程

#### 优点

- 内核可以在多个处理器上调度一个进程的多个线程实现同步并行执行
- 阻塞发生在线程级别
- 内核本身的处理可以通过多线程实现

#### 缺点

- 一个进程中的线程切换需要内核参与，涉及到内核的状态转换

- 降低效率