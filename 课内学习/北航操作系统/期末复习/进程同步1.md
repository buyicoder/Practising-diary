## 典型三类并发错误

- 数据竞争
- 原子性违反
- 死锁

### 临界区

## 同步机制应遵循的原则

- 空闲让进
  - 临界资源处于空闲状态，允许进程进入临界区
  - 临界区内仅有一个进程运行
- 忙则等待
  - 有进程正在执行临界区代码，所有其他进程不可以进入临界区
- 有限等待
  - 对要求访问临界区的进程，应保证在有限时间内进入自己的临界区，避免无线等
- 让权等待
  - 当进程长时间不能进入自己的临界区时，应立即释放处理机，尽量避免忙等耗费CPU资源

## 实现互斥的方法

- 屏蔽中断，危险而且可能屏蔽太久导致其它进程无法运行
- 共享锁变量，不是实际的解决办法，但是提供了一种思路
- 严格轮换法，是一种办法但是限制太多，只能严格轮换而且忙等待
- Peterson算法，是一种办法，不会严格轮换，提供了一种设计enter_region和leave_region的思路，就是严格轮换法加了一个interested数组，但是只能忙等待而且会导致优先级反转
- Bakery Algorithm
  - 进入临界区之前先取号，同时每个线程有一个量标记是否正在取号
  - 进入临界区之前，判断是否为最小的号，是则进入，否则忙等待
  - 出临界区归还号码
- 硬件指令机制



- ​	sleep&wakeup

- 信号量机制

  